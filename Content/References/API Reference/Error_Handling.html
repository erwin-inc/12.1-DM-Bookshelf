<?xml version="1.0" encoding="utf-8"?>
<html lang="en" xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Error Handling</title>
        <link href="..\..\Resources\StyleSheets\stylesheet.css" rel="stylesheet" type="text/css" />
        <link href="..\..\Resources\StyleSheets\docsstylesheet.css" rel="stylesheet" type="text/css" />
        <meta content="&lt;authorit:componentcd&gt;" name="componentcd" />
        <meta content="6178" name="objectid" />
        <meta content="260" name="basedOnKey" />
        <!--metadata variables for XMD: translatable-->
        <meta content="" name="description" />
        <meta content="&lt;authorit:ca_keywords&gt;" name="keywords" />
        <meta content="&lt;authorit:ca_content_type&gt;" name="ca_content_type" />
        <meta content="&lt;authorit:ca_context&gt;" name="ca_context" />
        <meta content="&lt;authorit:ca_role&gt;" name="ca_role" />
        <meta content="en-US" name="ca_language" />
        <!--metadata variables for XMD: do not translate-->
        <meta content="&lt;authorit:ca_offering_name&gt;" name="ca_offering_name" />
        <meta content="&lt;authorit:ca_product_version&gt;" name="ca_product_version" />
        <meta content="&lt;authorit:ca_product_family&gt;" name="ca_product_family" />
        <meta content="&lt;authorit:ca_alias_name&gt;" name="ca_alias_name" />
        <meta content="&lt;authorit:ca_related_offering&gt;" name="ca_related_offering" />
        <meta content="&lt;authorit:ca_access_level&gt;" name="ca_access_level" />
        <meta content="8/29/2018T10:23-5:00" name="ca_date_time" />
        <meta content="(supervisor)" name="ca_creator" />
        <meta content="&lt;authorit:ca_source&gt;" name="ca_source" />
        <meta content="HTML" name="ca_format" />
        <meta content="&lt;authorit:ca_database&gt;" name="ca_database" />
        <meta content="&lt;authorit:ca_application_server&gt;" name="ca_application_server" />
        <meta content="&lt;authorit:ca_operating_system&gt;" name="ca_operating_system" />
        <meta content="&lt;authorit:ca_star_code&gt;" name="ca_star_code" />
        <meta content="&lt;authorit:ca_cms_id&gt;" name="ca_cms_id" />
        <script language="javascript" type="text/javascript">
        </script> <script language="javascript" src="..\..\Resources\open_parent.js" type="text/javascript"></script> <script language="javascript" type="text/javascript"></script> <script language="javascript" type="text/javascript"></script></head>
    <body onload="loadParent();highlightx();if (isTOCLoaded()) {expand2('6060');highlight('6178')}">
        <p class="bodytext">
            <MadCap:concept term="References" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" />
        </p>
        <h2 class="heading2" id="t6178">Error Handling</h2>
        <p class="bodytext">The API uses a generic COM error object to handle errors. Depending on the programming environment, languages have their own protocols to retrieve errors from the generic error object. For example, C++ and Visual Basic .NET use exception handling to handle errors. To ensure a stable application, it is recommended that API clients use error handling to trap potential errors such as attempting to access an object that was deleted, or attempting to access an empty collection.</p>
        <p class="bodytext">Example 30</p>
        <p class="bodytext">The following example illustrates error handling using C++. It assumes that there is a <em class="italic">Model Object</em> object from Example 9:</p><pre xml:space="preserve">
long GetObjectProperties(ISCModelObjectPtr &amp; scObjPtr)
{    
     // Get the collection of Properties
     ISCModelPropertyCollectionPtr scPropColPtr;
     try
     {
         scPropColPtr = scObjPtr-&gt;GetProperties();
         if (!scPropColPtr.GetInterfacePtr())
         {
              AfxMessageBox("Unable to Get Properties Collection");
              return FALSE;
         }
         // …
     }
     catch(_com_error &amp;error)
     {
          AfxMessageBox(error.Description());
     }
}
</pre>
        <p class="bodytext">The following example illustrates error handling using Visual Basic .NET. It assumes that there is a <em class="italic">Model Object</em> object from Example 9:</p><pre xml:space="preserve">
Public Sub GetObject(ByRef scSession As SCAPI.Session, ByRef objID As String)
     Dim scObjCol as SCAPI.ModelObjects
     Dim scObj as SCAPI.ModelObject
     
     Try
         scObjCol = scSession.ModelObjects
         scObj = scObjCol.Item(objID)  ' retrieves object with given object ID
     Catch ex As Exception
         ' Failed
         Console.WriteLine(" API Failed With Error message :" + ex.Message())
     End Try
End Sub
</pre>
        <p class="bodytext">In addition to the generic error object, the API provides an extended error handling mechanism with the Application Environment Message log. The message log can handle a sequence of messages that is useful in a context of complex operations like transactions.</p>
        <p class="bodytext">More information about the Application Environment Message log organization is located in the <a class="z--jumptemplate" href="Property_Bag_for_Application_Environment.html" id="h6042" target="_self" title="Property Bag for Application Environment">Property Bag for Application Environment</a> section.</p>
        <p>
        </p>
    </body>
</html>