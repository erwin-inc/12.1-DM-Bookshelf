<?xml version="1.0" encoding="utf-8"?>
<html lang="en" xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>ISCModelObjectCollection Interface</title>
        <link href="..\..\Resources\StyleSheets\stylesheet.css" rel="stylesheet" type="text/css" />
        <link href="..\..\Resources\StyleSheets\docsstylesheet.css" rel="stylesheet" type="text/css" />
        <meta content="&lt;authorit:componentcd&gt;" name="componentcd" />
        <meta content="6107" name="objectid" />
        <meta content="260" name="basedOnKey" />
        <!--metadata variables for XMD: translatable-->
        <meta content="" name="description" />
        <meta content="&lt;authorit:ca_keywords&gt;" name="keywords" />
        <meta content="&lt;authorit:ca_content_type&gt;" name="ca_content_type" />
        <meta content="&lt;authorit:ca_context&gt;" name="ca_context" />
        <meta content="&lt;authorit:ca_role&gt;" name="ca_role" />
        <meta content="en-US" name="ca_language" />
        <!--metadata variables for XMD: do not translate-->
        <meta content="&lt;authorit:ca_offering_name&gt;" name="ca_offering_name" />
        <meta content="&lt;authorit:ca_product_version&gt;" name="ca_product_version" />
        <meta content="&lt;authorit:ca_product_family&gt;" name="ca_product_family" />
        <meta content="&lt;authorit:ca_alias_name&gt;" name="ca_alias_name" />
        <meta content="&lt;authorit:ca_related_offering&gt;" name="ca_related_offering" />
        <meta content="&lt;authorit:ca_access_level&gt;" name="ca_access_level" />
        <meta content="8/29/2018T10:23-5:00" name="ca_date_time" />
        <meta content="(supervisor)" name="ca_creator" />
        <meta content="&lt;authorit:ca_source&gt;" name="ca_source" />
        <meta content="HTML" name="ca_format" />
        <meta content="&lt;authorit:ca_database&gt;" name="ca_database" />
        <meta content="&lt;authorit:ca_application_server&gt;" name="ca_application_server" />
        <meta content="&lt;authorit:ca_operating_system&gt;" name="ca_operating_system" />
        <meta content="&lt;authorit:ca_star_code&gt;" name="ca_star_code" />
        <meta content="&lt;authorit:ca_cms_id&gt;" name="ca_cms_id" />
        <script language="javascript" type="text/javascript">
        </script> <script language="javascript" src="..\..\Resources\open_parent.js" type="text/javascript"></script> <script language="javascript" type="text/javascript"></script> <script language="javascript" type="text/javascript"></script></head>
    <body onload="loadParent();highlightx();if (isTOCLoaded()) {expand2('6060');expand2('6097');expand2('6106');highlight('6107')}">
        <p class="bodytext">
            <MadCap:concept term="References" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" />
        </p>
        <h4 class="heading4" id="t6107">ISCModelObjectCollection Interface</h4>
        <p class="bodytext">The following table contains information on the <em class="italic">ISCModelObjectCollection</em> interface:</p>
        <p class="beforetablefull">
        </p>
        <table border="0" cellpadding="2" cellspacing="0" class="tableintopic" style="border-collapse: collapse;" width="624">
            <tr align="left" valign="top">
                <th style="border-top: 2px solid #010101;border-bottom: 2px solid #010101;" width="184">
                    <p class="tableheading">Signature</p>
                </th>
                <th style="border-top: 2px solid #010101;border-bottom: 2px solid #010101;" width="168">
                    <p class="tableheading">Description</p>
                </th>
                <th style="border-top: 2px solid #010101;border-bottom: 2px solid #010101;" width="272">
                    <p class="tableheading">Valid Arguments</p>
                </th>
            </tr>
            <tr align="left" valign="top">
                <td style="border-top: 1px solid #010101;border-bottom: 2px solid #010101;" width="184">
                    <p class="tablebodytext">ISCModelObjectCollection * Collect(VARIANT Root, VARIANT ClassId [optional], VARIANT Depth [optional], VARIANT MustBeOn [optional], VARIANT MustBeOff [optional])</p>
                </td>
                <td style="border-top: 1px solid #010101;border-bottom: 2px solid #010101;" width="168">
                    <p class="tablebodytext">Creates a Model Objects collection, which represents a subcollection of itself.</p>
                    <p class="tablebodytext">The method creates a valid collection even though the collection may be empty.</p>
                </td>
                <td style="border-top: 1px solid #010101;border-bottom: 2px solid #010101;" width="272">
                    <p class="tablebodytext">Root:</p>
                    <ul class="tablelistbullet">
                        <li class="tablelistbullet">VT_UNKNOWN � ISCModelObject pointer of the root object. Returns the descendants of the given object.
</li>
                        <li class="tablelistbullet">VT_BSTR � The Object ID of the root object. Returns the descendants of the object with the given object identifier.
</li>
                    </ul>
                    <p class="tablebodytext">ClassId:</p>
                    <ul class="tablelistbullet">
                        <li class="tablelistbullet">VT_ARRAY|VT_BSTR � SAFEARRAY of class IDs. Returns the descendants of the root with the given object class identifiers.
</li>
                        <li class="tablelistbullet">VT_ARRAY|VT_BSTR � SAFEARRAY of class names. Returns the descendants of the root with the given object class name.
</li>
                        <li class="tablelistbullet">VT_BSTR � Class ID. Returns the descendants of the root with the given object class identifier.
</li>
                        <li class="tablelistbullet">VT_BSTR � Semicolon delimited list of class IDs. Returns the descendants of the root with the given class identifiers.
</li>
                        <li class="tablelistbullet">VT_BSTR � Class name. Returns the descendants of the root with the given class name.
</li>
                        <li class="tablelistbullet">VT_BSTR � Semicolon delimited list of class names. Returns the descendants of the root with the given class names. 
</li>
                        <li class="tablelistbullet">Empty � Returns all descendants regardless of class type.
</li>
                    </ul>
                </td>
            </tr>
            <tr align="left" valign="top">
                <td style="border-top: 1px solid #010101;border-bottom: 2px solid #010101;" width="184">
                    <p class="tablebodytext">�</p>
                </td>
                <td style="border-top: 1px solid #010101;border-bottom: 2px solid #010101;" width="168">
                    <p class="tablebodytext">�</p>
                    <p class="tablebodytext">�</p>
                </td>
                <td style="border-top: 1px solid #010101;border-bottom: 2px solid #010101;" width="272">
                    <p class="tablebodytext">Depth:</p>
                    <ul class="tablelistbullet">
                        <li class="tablelistbullet">VT_I4 � Maximum depth. Returns the descendants of the root at a depth no more than the given depth. A depth of -1 represents unlimited depth.
</li>
                        <li class="tablelistbullet">Empty � Returns all descendants of the root (unlimited depth).
</li>
                    </ul>
                    <p class="tablebodytext">MustBeOn:</p>
                    <ul class="tablelistbullet">
                        <li class="tablelistbullet">VT_I4 � Returns the descendants of the root with the given object flags set.
</li>
                        <li class="tablelistbullet">Empty � Defaults to SCD_MOF_DONT_CARE.
</li>
                    </ul>
                    <p class="tablebodytext">MustBeOff:</p>
                    <ul class="tablelistbullet">
                        <li class="tablelistbullet">VT_I4 � Returns the descendants of the root that do not have the given object flags set.
</li>
                        <li class="tablelistbullet">Empty � Defaults to SCD_MOF_DONT_CARE.
</li>
                    </ul>
                </td>
            </tr>
        </table>
        <p class="noteAlt">For information about valid object class names and identifiers, see the HTML document <em class="italic">erwin Metamodel Reference</em>, in the Metamodel Reference Bookshelf located in the erwin Data Modeler installation folder. More information about <em class="italic">SC_ModelObjectFlags</em> is located in the appendix <a class="z--jumptemplate" href="API_Interfaces_Reference_Appendix.html" id="h6061" target="_self" title="API Interfaces Reference">API Interfaces Reference</a>.</p>
        <p class="bodytext">The following sections show the code examples for the different filters.</p>
        <p class="bodytext">Example 10</p>
        <p class="bodytext">The following example illustrates the <em class="italic">Object Type</em> filter using C++. The example uses the <em class="italic">Session</em> object from Example 6 and creates a collection of objects of <em class="italic">csType</em> type, owned by the <em class="italic">rootObj</em> object:</p><pre xml:space="preserve">
void FilterObjects(ISCSessionPtr scSessionPtr, ISCModelObjectPtr &amp; rootObj, 
CString &amp; csType)
{   
    ISCModelObjectCollectionPtr scModelObjectsPtr;
scModelObjectsPtr = scSessionPtr-&gt;GetModelObjects()-&gt;Collect(rootObj-&gt;GetObjectId(), COleVariant(csType));
    // …
}
</pre>
        <p class="bodytext">The following example illustrates the <em class="italic">Object Type</em> filter using Visual Basic .NET. The example uses the <em class="italic">Session</em> object from Example 6 and creates a collection of objects of <em class="italic">csType</em> type, owned by the <em class="italic">rootObj</em> object:</p><pre xml:space="preserve">
Public Sub FilterObjects(ByRef scSession As SCAPI.Session, _
                        ByRef rootObj As SCAPI.ModelObject, ByRef objType as String)
    
    Dim scModelObjects As SCAPI.ModelObjects
    scModelObjects = scSession.ModelObject.Collect(rootObj, objType)
    ' scModelObjects will contain only objects of type objType
End Sub
</pre>
        <p class="bodytext">Example 11</p>
        <p class="bodytext">The following example illustrates the <em class="italic">Depth</em> filter using C++:</p><pre xml:space="preserve">
void FilterObjects(ISCSessionPtr scSessionPtr, ISCModelObjectPtr &amp; rootObj,
CString &amp; csType, long depth)
{   
    ISCModelObjectCollectionPtr scModelObjectsPtr;
    scModelObjectsPtr = scSessionPtr-&gt;GetModelObject()-&gt;
           Collect(rootObj-&gt;GetObjectId(), COleVariant(csType),depth);
    // …
}
</pre>
        <p class="bodytext">The following example illustrates the <em class="italic">Depth</em> filter using Visual Basic .NET:</p><pre xml:space="preserve">
Public Sub FilterObjects(ByRef scSession As SCAPI.Session, _
           ByRef rootObj As SCAPI.ModelObject, ByRef classID As String, depth As Integer)
    Dim scModelObjects As SCAPI.ModelObjects
    scModelObjects = scSession.ModelObjects.Collect(rootObj, classID, depth)
End Sub
</pre>
        <p class="bodytext">Example 12</p>
        <p class="bodytext">The following example illustrates the <em class="italic">MustBeOn/MustBeOff</em> filter using C++. The example uses the <em class="italic">Session</em> object from Example 6:</p><pre xml:space="preserve">
void FilterObjects(ISCSessionPtr scSessionPtr, ISCModelObjectPtr &amp; rootObj, long depth)
{
     ISCModelObjectCollectionPtr scModelObjectsPtr;
     scModelObjectsPtr = scSessionPtr-&gt;GetModelObjects()-&gt;
          Collect(rootObj-&gt;GetObjectId(), vtMissing, depth, SCD_MOF_USER_DEFINED);
      // …
}
</pre>
        <p class="bodytext">The following example illustrates the <em class="italic">MustBeOn/MustBeOff</em> filter using Visual Basic .NET. The example uses the <em class="italic">Session</em> object from Example 6:</p><pre xml:space="preserve">
Public Sub FilterObjects(ByRef scSession As SCAPI.Session, _
           ByRef rootObj As SCAPI.ModelObject, depth As Integer)
    
    Dim scModelObjects As SCAPI.ModelObjects
    scModelObjects = scSession.ModelObjects.Collect(rootObj, , depth, SCD_MOF_USER_DEFINED)
End Sub
</pre>
        <p class="bodytext">The following example illustrates how to create a note through API:</p><pre xml:space="preserve">
Sub updateAttribute()
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
  ' This Creates an Instance of SCApplication
</pre><pre xml:space="preserve">
  Set SCApp = CreateObject("erwin9.SCAPI")
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
   'Declare a variable as a FileDialog object.
</pre><pre xml:space="preserve">
  Dim fd As FileDialog
</pre><pre xml:space="preserve">
  'Create a FileDialog object as a File Picker dialog box.
</pre><pre xml:space="preserve">
  Set fd = Application.FileDialog(msoFileDialogFilePicker)
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
  fd.AllowMultiSelect = False
</pre><pre xml:space="preserve">
  fd.Filters.Clear
</pre><pre xml:space="preserve">
  fd.Filters.Add "erwin File", "*.erwin", 1
</pre><pre xml:space="preserve">
  If (fd.Show = -1) Then
</pre><pre xml:space="preserve">
      strFileName = fd.SelectedItems.Item(1)
</pre><pre xml:space="preserve">
  Else
</pre><pre xml:space="preserve">
      Exit Sub
</pre><pre xml:space="preserve">
  End If
</pre><pre xml:space="preserve">
  'Set the object variable to Nothing.
</pre><pre xml:space="preserve">
  Set fd = Nothing
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
 'strFileName = "C:\models\test03.erwin"
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
   '  This is the name of the .erwin Model that needs to be updated
</pre><pre xml:space="preserve">
  Set SCPUnit = SCApp.PersistenceUnits.Add("erwin://" &amp; strFileName)
</pre><pre xml:space="preserve">
  Set SCSession = SCApp.Sessions.Add
</pre><pre xml:space="preserve">
  SCSession.Open (SCPUnit)
</pre><pre xml:space="preserve">
  Set SCRootObj = SCSession.ModelObjects.Root
</pre><pre xml:space="preserve">
  Set SCEntObjCol = SCSession.ModelObjects.Collect(SCRootObj, "Entity")
</pre><pre xml:space="preserve">
Dim nTransId
</pre><pre xml:space="preserve">
nTransId = SCSession.BeginNamedTransaction("Test")
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
    For Each oEntObject In SCEntObjCol
</pre><pre xml:space="preserve">
      On Error Resume Next
</pre><pre xml:space="preserve">
      Set oEntCol = SCSession.ModelObjects.Collect(oEntObject, "Attribute")
</pre><pre xml:space="preserve">
        For Each oAttObject In oEntCol
</pre><pre xml:space="preserve">
            Set oUserNote = SCSession.ModelObjects.Collect(oAttObject).Add("Extended_Notes")
</pre><pre xml:space="preserve">
            oUserNote.Properties("Comment").Value = "Test note1"
</pre><pre xml:space="preserve">
            oUserNote.Properties("Note_Importance").Value = "0"     'enum {0|1|2|3|4|5}
</pre><pre xml:space="preserve">
            oUserNote.Properties("Status").Value = "1"              'enum {1|2|3}
</pre><pre xml:space="preserve">
        Next oAttObject
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
    Next oEntObject
</pre><pre xml:space="preserve">
SCSession.CommitTransaction (nTransId)
</pre><pre xml:space="preserve">
SCSession.Close
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
' Save the model
</pre><pre xml:space="preserve">
Call SCPUnit.Save("erwin://" &amp; strFileName)
</pre><pre xml:space="preserve">
MsgBox "Incremental-Save successfully"
</pre><pre xml:space="preserve">
SCApp.Sessions.Remove (SCSession)
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
SCApp.PersistenceUnits.Clear
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
SCPUnit = Null
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
SCSession = Null
</pre><pre xml:space="preserve"></pre><pre xml:space="preserve">
End Sub

</pre>
        <p>
        </p>
    </body>
</html>